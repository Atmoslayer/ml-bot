# Чат боты поддержки
Проект содержит чат ботов для телеграмма и вконтакте для общения с пользователями в формате тех-поддержки.
Боты подключены к нейросети [DialofFlow](https://cloud.google.com/dialogflow). Проект позволяет обучать нейросеть давать конкретные 
ответы на задаваемые вопросы.
## Как установить
### Для телеграмм бота
Необходимо создать телеграм-бота с помощью отца ботов @BotFather, написав ему и выбрав имена для бота. 
После этого будет получен токен, подобный этому: `1234567890:ABCDEFGHIjklmnoPqrsStuvwxyzINet1234`.
Логи работы телеграмм бота отсылаются администратору, телеграмм id которого можно получить,
написав боту @getmyid_bot.
После этого будет получен id на подобие этого: `1234567891`.
### Для ВК бота
Необходимо создать группу ВКонтакте, разрешить в ней отправлять сообщения и получить токен в разделе
`Работа с API`.
В том же разделе появится токен на подобии этого: `vk1.a.4-Abcdfghij_klmnOp...gdf`.
Логи работы вк бота присылаются администратору, вк id которого можно получить из ссылки на свою страницу.
Если id пользователя не меняли, обычно это набор цифр на подобии этого: `1234567778`.
### Для работы с нейросетью
Необходимо [создать](https://dialogflow.cloud.google.com) аккаунт DialogFlow согласно 
[инструкции](https://cloud.google.com/dialogflow/es/docs/quick/setup), после чего создать агента по следующей [инструкции](https://cloud.google.com/dialogflow/docs/quick/build-agent).
После создания проекта необходимо сохранить id проекта содержащий в себе его название, который будет указан на его главной странице.
Пример id: `dialog-flow-project`.
Затем необходимо [включить API](https://cloud.google.com/dialogflow/es/docs/quick/setup#api).
С помощью [консольной утилиты](https://cloud.google.com/dialogflow/es/docs/quick/setup#sdk) необходимо получить 
json файл с ключами и добавить его к проекту.
Теперь необходимо [получить токен](https://cloud.google.com/docs/authentication/api-keys) для DialogFlow на подобие этого:
`AbcgfjRglkgjdfgERjgjkllgdfsdfopwr`.
### Для работы проекта
Для хранения токенов в проекте используются переменные окружения. После получения токены и путь к json файлу с ключами необходимо добавить в файл `.env`.
Пример заполненного файла:
```
TG_BOT_TOKEN=1234567890:ABCDEFGHIjklmnoPqrsStuvwxyzINet1234
GOOGLE_APPLICATION_CREDENTIALS=credentials.json
GOOGLE_CLOUD_PROJECT=AbcgfjRglkgjdfgERjgjkllgdfsdfopwr
TG_ADMIN_CHAT_ID=1234567891
VK_ADMIN_ID=1234567778
PROJECT_ID=dialog-flow-project
VK_TOKEN=vk1.a.4-Abcdfghij_klmnOp...gdf
```
Python3 должен быть уже установлен.
Затем используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:
```
>>>pip install -r requirements.txt
```
## Запуск телеграмм бота
Бот запускается командой:
```
>>>python3 telegram_bot.py           
```
## Запуск ВК бота
Бот запускается командой:
```
>>>python3 vk_bot.py           
```
## Запуск обучения нейросети
Для запуска обучения нейросети нужно создать и заполнить json файл, содержащий группированные по темам
вопросы и ответ на них. Пример заполнения файла:
```
{
    "Устройство на работу": {
        "questions": [
            "Как устроиться к вам на работу?",
            "Как устроиться к вам?",
            "Как работать у вас?",
            "Хочу работать у вас",
            "Возможно-ли устроиться к вам?",
            "Можно-ли мне поработать у вас?",
            "Хочу работать редактором у вас"
        ],
        "answer": "Если вы хотите устроиться к нам, напишите на почту game-of-verbs@gmail.com мини-эссе о себе и прикрепите ваше портфолио."
    },
}
```
Путь к файлу указывается с помощью аргумента `--questions_path` (по умолчанию указано questions).
Обучение запускается следующей командой:
```
>>>python3 train_network.py --questions_path C:\Users\atmoslayer\questions.json
```
Если создаваемый набор уже существует в проекте, его создание будет пропущено и в консоль будет выдано
соответствующее уведомление.
## Примеры ботов
Проект содержит рабочие версии [телегамм бота](https://t.me/AI_Helper_Atmoslayer_Bot) и бота, подключенного к [группе ВКонтакте](https://vk.com/club212911768).
## Цель проекта
Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).